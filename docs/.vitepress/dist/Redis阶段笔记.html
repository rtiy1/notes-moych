<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VitePress</title>
    <meta name="description" content="A VitePress site">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/assets/style.DFTx90Kk.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.t335zRP2.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.ClvlwmeV.js">
    <link rel="modulepreload" href="/assets/chunks/framework.CDjunVez.js">
    <link rel="modulepreload" href="/assets/Redis阶段笔记.md.Ck6CnxmI.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0b0ada53></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0b0ada53>Skip to content</a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar" data-v-ae24b3ad data-v-6aa21345><div class="wrapper" data-v-6aa21345><div class="container" data-v-6aa21345><div class="title" data-v-6aa21345><div class="VPNavBarTitle" data-v-6aa21345 data-v-1168a8e4><a class="title" href="/" data-v-1168a8e4><!--[--><!--]--><!----><span data-v-1168a8e4>VitePress</span><!--[--><!--]--></a></div></div><div class="content" data-v-6aa21345><div class="content-body" data-v-6aa21345><!--[--><!--]--><div class="VPNavBarSearch search" data-v-6aa21345><!----></div><!----><!----><div class="VPNavBarAppearance appearance" data-v-6aa21345 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-6aa21345 data-v-bb2aa2f0 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-cf11d7a2><span class="vpi-more-horizontal icon" data-v-cf11d7a2></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><!----><!--[--><!--[--><!----><div class="group" data-v-bb2aa2f0><div class="item appearance" data-v-bb2aa2f0><p class="label" data-v-bb2aa2f0>Appearance</p><div class="appearance-action" data-v-bb2aa2f0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bb2aa2f0 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6aa21345 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-6aa21345><div class="divider-line" data-v-6aa21345></div></div></div><!----></header><div class="VPLocalNav empty fixed" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><!----><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-8a42e2b4><button data-v-8a42e2b4>Return to top</button><!----></div></div></div><!----><div class="VPContent" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-a5bbad30><div class="content" data-v-a5bbad30><div class="outline-marker" data-v-a5bbad30></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a5bbad30>On this page</div><ul class="VPDocOutlineItem root" data-v-a5bbad30 data-v-b933a997><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _Redis%E9%98%B6%E6%AE%B5%E7%AC%94%E8%AE%B0" data-v-39a288b8><div><h2 id="redis阶段" tabindex="-1">Redis阶段： <a class="header-anchor" href="#redis阶段" aria-label="Permalink to &quot;Redis阶段：&quot;">​</a></h2><h3 id="事务和锁机制" tabindex="-1">事务和锁机制： <a class="header-anchor" href="#事务和锁机制" aria-label="Permalink to &quot;事务和锁机制：&quot;">​</a></h3><hr><h4 id="_1、redis事务的控制方式" tabindex="-1">1、Redis事务的控制方式： <a class="header-anchor" href="#_1、redis事务的控制方式" aria-label="Permalink to &quot;1、Redis事务的控制方式：&quot;">​</a></h4><p>事务为单线程核心执行的，事务执行的操作命令一般有</p><table tabindex="0"><thead><tr><th>命令名称</th><th>作用</th></tr></thead><tbody><tr><td>multi</td><td>宣告开始把命令加入队列</td></tr><tr><td>discard</td><td>对于已经加入队列的命令，放弃执行</td></tr><tr><td>exec</td><td>执行队列中的每一条命令</td></tr><tr><td>watch</td><td>在 <code>MULTI</code> 之前使用，用于乐观锁机制：监视一个或多个 key。如果在 <code>EXEC</code> 执行前这些 key 被其他客户端修改，则整个事务会被取消（<code>EXEC</code> 返回 <code>nil</code>）。</td></tr></tbody></table><p>Redis事务具有原子性的特点，但是在发生<code>运行时错误</code>的时候，继续执行。</p><p>语法错误（入队时报错）：如命令不存在、参数错误等，在 <code>EXEC</code> 时整个事务会被拒绝执行。</p><p>运行时错误（执行时报错）：如对错误的数据类型操作，该命令失败但其余命令继续执行。</p><p>Redis事务不支持回滚。</p><h4 id="_2、乐观锁和悲观锁" tabindex="-1">2、乐观锁和悲观锁： <a class="header-anchor" href="#_2、乐观锁和悲观锁" aria-label="Permalink to &quot;2、乐观锁和悲观锁：&quot;">​</a></h4><p>悲观锁：写操作占比高，并发写的几率高，用同步锁保护自身操作，自己进行操作时，不允许其他线程执行。</p><p><strong>乐观锁</strong>：读操作占比高，碰撞几率低，不锁定数据，充分保证并发操作同时执行。如果在自己进行写操作时，其他线程操作修改了数据，则自己（本线程）会放弃自身操作。</p><h2 id="rdb和aof" tabindex="-1">RDB和AOF： <a class="header-anchor" href="#rdb和aof" aria-label="Permalink to &quot;RDB和AOF：&quot;">​</a></h2><p>RDB持久化：</p><p>RDB 持久化通过 <code>BGSAVE</code> 实现：主进程 <code>fork</code> 出子进程，子进程基于 COW 机制读取 fork 时刻的内存快照并写入 <code>.rdb</code> 文件。主进程继续服务，无阻塞。RDB 是全量快照，适合备份和快速恢复，但可能丢失最后一次快照后的数据。</p><p>AOF持久化：</p><p>需要手动在配置文件里面将AOF配置设置为yes，这样在操作过程中所使用的每一条命令都会记录在当前目录的.aof文件中，方便在服务器宕机时直接调用AOF的命令重建内存数据集。AOF里有三种持久化频率，第一种为<code>always</code>，指的是每次写入都进行持久化，第二种为<code>everysec</code>，指的是每一秒进行一次AOF持久化，第三种为<code>no</code>，由操作系统决定何时同步。一般来说，第二种选择比较好。</p><p>AOF 重写不是合并重复命令，而是基于当前内存状态生成最简重建命令，从而压缩 AOF 文件体积（磁盘空间）。通过 <code>BGREWRITEAOF</code> 触发，利用 fork + COW 机制实现在线无阻塞重写，确保数据一致性。</p></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-e257564d><!--[--><!--]--><!----><!----></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"index.md\":\"B9w0MgEJ\",\"redis阶段笔记.md\":\"Ck6CnxmI\",\"ssm阶段学习笔记.md\":\"mdvsCTWn\",\"算法套路总结.md\":\"Cak8Pqu1\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"VitePress\",\"description\":\"A VitePress site\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>